<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Practical 1-6: Writing a report in RStudio</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="section-header">



<h1 class="title toc-ignore">Practical 1-6: Writing a report in RStudio</h1>

</div>


<div id="section-overview" class="section level2">
<h2>Overview</h2>
<p><em>In this session we will take the code for the models with just growth (1-4)</em> <em>and with births and deaths (1-5) and make a clearer report comparing the two.</em></p>
<blockquote>
<p>Note that from here on out you need to have two versions of RStudio open at a time. One to run the {learnr} course (this will likely have a big red stop button preventing you from being able to run anything in the Console) and one to do your work in. If you don’t still have it open, you should be able to open the new project that you created in Practical 1-1 using <span style="color: #de77ae;">File &gt; Open Project in New Session…</span> in RStudio or follow the instructions in 1-1 to create another new project if you want to do that.</p>
</blockquote>
</div>
<div id="section-background" class="section level2">
<h2>Background</h2>
<p>We are now going to demonstrate in a small way why it’s worth dividing up the code into separate functions, and indeed separate files. Previously we wrote a simple growth model, and a model of birth and death. We’re now going to use the two-step functions we created and run both models in a new script that compares them. For this final part of practical 1, we’re going to generate a report in RStudio using everything we’ve learned so far.</p>
</div>
<div id="section-a-clean-start" class="section level2">
<h2>A clean start</h2>
<p>Sometimes you can find that something you have done before in R can interfere with what you are now doing – though if you’ve written all of your code correctly, then obviously(!) this should never happen. It is useful then to know that you can clear what is held in R’s memory using <code>rm(list=ls())</code>. This will cause all of the variables and functions in your <strong>Global Environment</strong> to disappear (<em>e.g.</em> if you type <code>human.annual.growth</code> in the R console it should tell you that the object is “not found”). As a fundamental rule however, you should <strong>never hardcode</strong> <code>rm(list=ls())</code> <strong>into any of your scripts</strong>, and in fact you should just not use it. It’s generally a sign your code isn’t written well if it can be affected by something before it. Instead, you can clear your workspace by clicking the brush in the <span style="color: #de77ae;">Environment</span> tab in RStudio (or <span style="color: #de77ae;">Session &gt; Clear Workspace…</span> in the menus).</p>
<p>However, generally it’s easier to Restart R. This is much safer and more final. You can do it in RStudio via <span style="color: #de77ae;">Session &gt; Restart R</span> in the menus: it is far more effective than clearing just the workspace as it resets everything, while leaving RStudio itself unaffected. Remember that once you have done this you may have to set the working directory to the correct folder, and you will certainly have to start running your code again completely from the beginning.</p>
<p>Note that, when you generate a report from the script file, they are always generated from a new, clean, version of R. So this is a very important final check that all of your code is working correctly – it’s as if you did restart R without actually wiping everything in your current R console - but only if you read it and check it looks right!</p>
<p>The other check we strongly encourage you to do is to check that your function does not use any global variables by using <code>findGlobals()</code>.</p>
<p>You should also generate a report for any function files you create. If you want to, you can put the <code>findGlobals()</code> check into this function file (which will run the check when you generate the report for that file) so it doesn’t clutter up the main script itself. But this is only useful if you generate a report from the function file! To solve this, you can make it so the report will fail to generate for that script when global variables are used with the following code snippets:</p>
<pre class="r"><code># Now check that function doesn&#39;t have any global variables.
library(codetools)
globals &lt;- findGlobals(step_simple_growth, merge = FALSE)$variables 
if (length(globals) != 0) {
  stop(&quot;Function step_simple_growth() may not use global variable(s): &quot;, globals)
}</code></pre>
</div>
<div id="section-tasks" class="section level2">
<h2>Tasks</h2>
<p>Remember again that our first model of simple population growth model looks like this:</p>
<p><span class="math display">\[N(t+1) = N(t) + \lambda \times N(t)\]</span></p>
<p>The birth and death model is slightly more complex:</p>
<p><span class="math display">\[ N(t+1) = N(t) + b \times N(t) – d \times N(t)\]</span></p>
<p>Remember that <span style="color: #de77ae;">0104-step-growth.r</span> has the <code>step_deterministic_growth()</code> function and <span style="color: #de77ae;">0105-step-birth-death.r</span> has the <code>step_deterministic_birth_death()</code> function, so we need to <code>source()</code> both of these files (as well as <span style="color: #de77ae;">0104-plot-helper.r</span>).</p>
<p>Now open RStudio. For this practical, we’re going to generate a report called <span style="color: #de77ae;">0106-final-report.r</span>. We want to compare the models, so write some code that first runs a simulation with one model and plots it, and then with the other model and plots that as well. Remember that you can plot a second (or third, etc.) result on top of a first with commands like:</p>
<pre class="r"><code>plot_populations(population.b, new.graph = FALSE, col = &quot;red&quot;)</code></pre>
<p>You should try running:</p>
<ol style="list-style-type: decimal">
<li>The birth-death model with a single given birth and death rate</li>
<li>The simple growth model with the birth rate as the growth rate</li>
<li>The simple growth model with minus the death rate as the (negative) growth rate</li>
<li>The simple growth model with the difference (between the rates in 1) as the growth rate</li>
</ol>
<p>When you try to run your code you should find that the graphs are very likely on different scales. You can set the y-axis limits of the second graph to the same as the first by reading off what they are on the first graph, and then plotting the second as follows:</p>
<pre class="r"><code>plot_populations(population.df, ylim = c(0, 20000000000))</code></pre>
<p>Once you’ve done this it should be easier to compare the two (by eye at least).</p>
</div>
<div id="section-report" class="section level2">
<h2>Report</h2>
For this report, we want something substantially clearer and better laid out, showing something that demonstrates the relationship between the growth and the birth-death models, noting for instance that the crude global birth and death rates are around 23 per 1000 population and 8 per 1000 respectively. You can see an example of most of the possible formatting options in <span style="color: #de77ae;">0100-example-notebook.r</span>. Use an understanding of what you want to describe – and formatting from the example file or elsewhere – to break up your script so that your code and the results and figures are interspersed with a reasonable explanation of what is going on. 
<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)
tutorial_options(exercise.reveal_solution = FALSE)
gradethis::gradethis_setup()
 
knitr::opts_chunk$set(error = TRUE)
set.seed(123)
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42]}},"value":[{"type":"character","attributes":{},"value":["backports","base","checkmate","codetools","compiler","curl","datasets","digest","ellipsis","evaluate","fastmap","gradethis","graphics","grDevices","htmltools","htmlwidgets","httpuv","jsonlite","knitr","later","learnr","lifecycle","magrittr","markdown","methods","mime","promises","R6","Rcpp","rlang","rmarkdown","rprojroot","shiny","stats","stringi","stringr","tools","utils","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.2.1","4.0.3","2.0.0","0.2-16","4.0.3","4.3","4.0.3","0.6.27","0.3.1","0.14","1.1.0","0.2.0.9001","4.0.3","4.0.3","0.5.1.9000","1.5.3","1.5.5","1.7.2","1.30","1.1.0.1","0.10.1.9007","0.2.0","2.0.1","1.1","4.0.3","0.9","1.1.1","2.5.0","1.0.6","0.4.10","2.6","2.0.2","1.5.0","4.0.3","1.5.3","1.4.0","4.0.3","4.0.3","2.4.0","0.20","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
