<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>3-1: Writing an R package</title>


<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>





<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="section-header">



<h1 class="title toc-ignore">3-1: Writing an R package</h1>

</div>


<div id="section-overview" class="section level2">
<h2>Overview</h2>
<p><em>In this practical we will learn how to create an R package.</em></p>
</div>
<div id="section-background" class="section level2">
<h2>Background</h2>
<p>For more information, follow this <a href="https://r-pkgs.org">link</a>.</p>
</div>
<div id="section-tasks" class="section level2">
<h2>Tasks</h2>
<p>We have written a function that will generate an R package for you to look at. In the following example, we have set <span style="color: #de77ae;">~/Desktop/git</span> as our working directory (this is where we keep all of our projects) and run <code>dummy_package("githubusername")</code>, replacing <code>githubusername</code> with your actual GitHub username.</p>
<p>A new instance of RStudio should open:</p>
<p><img src="images/package.png" width="100%" style="display: block; margin: auto;" /></p>
<p>You should find that (1) your working directory is now <span style="color: #de77ae;">githubusername</span>, (2) inside this directory are a number of files and directories:</p>
<ul>
<li><span style="color: #de77ae;">.gitignore</span>: contains regular expressions that should be ignored by Git, more info <a href="https://www.pluralsight.com/guides/how-to-use-gitignore-file">here</a></li>
<li><span style="color: #de77ae;">.Rbuildignore</span>: contains regular expressions that should be ignored by R CMD check / when building the package from source, more info <a href="https://r-pkgs.org/package-structure-state.html#rbuildignore">here</a></li>
<li><span style="color: #de77ae;">.Rhistory</span>: contains R command history, accessed by pressing the up key in the Console</li>
<li><span style="color: #de77ae;">demo/</span>: contains R demo files, more info <a href="https://r-pkgs.org/misc.html#demo">here</a> (which we’ve populated with <span style="color: #de77ae;">d0301_run_birth_death.R</span>, the script from Practical 1-5)</li>
<li><span style="color: #de77ae;">DESCRIPTION</span>: contains metadata about your package, more info <a href="https://r-pkgs.org/description.html">here</a></li>
<li><span style="color: #de77ae;">man/</span>: contains code used to generate documentation when the package is built (don’t edit these files), more info <a href="https://r-pkgs.org/man.html#man-workflow">here</a></li>
<li><span style="color: #de77ae;">NAMESPACE</span>: contains the names of imported and exported functions (don’t edit this file), more info <a href="https://r-pkgs.org/namespace.html#namespace">here</a></li>
<li><span style="color: #de77ae;">githubusername.Rproj</span>: an RStudio project file, which is used to make this directory an RStudio project, and can be used as a shortcut for opening this project from your filesystem, more info <a href="https://support.rstudio.com/hc/en-us/articles/200526207-Using-Projects">here</a></li>
<li><span style="color: #de77ae;">R/</span>: contains code used to generate functions when the package is built (which we’ve populated with <span style="color: #de77ae;">step_deterministic_birth_death.R</span>, the step function from Practical 1-5), more info <a href="https://r-pkgs.org/r.html#code-organising">here</a></li>
</ul>
<p>and (3) an RStudio project has been set up, called <span style="color: #de77ae;">githubusername</span>. Feel free to explore these files and make sure you have a good grasp of what they do.</p>
<p>To install this package on your machine, make sure you’re in the root directory (in this case, <span style="color: #de77ae;">~Desktop/git/githubusername/</span>) and run:</p>
<pre class="r"><code>devtools::install()</code></pre>
<p>Note that <code>devtools::</code> is equivant to calling <code>library()</code> on <code>devtools</code>, so if you’ve already done that, you can just call <code>install()</code> directly.</p>
<div id="section-demo" class="section level3">
<h3>Demo</h3>
<p>Try running the demo:</p>
<pre class="r"><code>demo(topic = &quot;d0301_run_birth_death&quot;, package = &quot;githubusername&quot;)</code></pre>
<p>As you can see in <span style="color: #de77ae;">demo/d0301_run_birth_death.R</span>, this is just a standard script. Any script in the <span style="color: #de77ae;">demo</span> directory that has been installed as part of a package can be run using <code>demo()</code>. Calling <code>demo(package = "githubusername")</code> lists all of the demos installed as part of the {githubusername} package.</p>
<p>Note the <span style="color: #de77ae;">demo/00Index</span> file, which is lists each demo alongside a description, on a single line. When adding a new entry, remember to put three spaces between the demo name and its description or you won’t see it in the demo list.</p>
<p>When you add your own demos, you need to run <code>devtools::install()</code> to permanently install them as part of your package.</p>
</div>
<div id="section-package-documentation" class="section level3">
<h3>Package documentation</h3>
<p>Look at the package documentation by using the <code>help()</code> function, or running:</p>
<pre class="r"><code>library(githubusername) 
?githubusername</code></pre>
<p>This documentation was generated from <span style="color: #de77ae;">R/githubusername-package.R</span>. Open this file and compare its contents with the documentation generated in RStudio. Go ahead and edit the <code>@author</code> field. This is your package now.</p>
<p>Remember that any changes you make to the package documentation won’t yet be visible. You need to run <code>devtools::install()</code> to permanently install them as part of your package.</p>
<p>Note that if you scroll to the bottom of the help function and click on <span style="color: #de77ae;">Index</span> you’ll get a list of functions exported by this package.</p>
</div>
<div id="section-function-documentation" class="section level3">
<h3>Function documentation</h3>
<p>Look at the help file for <code>step_deterministic_birth_death()</code> and compare this to <span style="color: #de77ae;">R/step_deterministic_birth_death.R</span>, which gives you a simple example of how functions are documented.</p>
<p>When you add your own function to a package, after having written the {Roxygen2} comments, you should run <code>devtools::document()</code> to generate the <span style="color: #de77ae;">man/</span> files and edit the <span style="color: #de77ae;">NAMESPACE</span>. You should then run <code>devtools::install()</code> to permanently install them as part of your package.</p>
</div>
<div id="section-package-metadata" class="section level3">
<h3>Package metadata</h3>
<p>Open the <span style="color: #de77ae;">DESCRIPTION</span> file. This file is used to record package dependencies. We’ve added a dependency on {RPiR} so you can see how to add one. Three things are required:</p>
<ul>
<li>Add an entry in the <span style="color: #de77ae;">Imports</span> field of the DESCRIPTION file</li>
<li>Add an <code>@import</code> in the <span style="color: #de77ae;">githubusername-package</span> file</li>
<li>Run <code>devtools::document()</code> to populate the <span style="color: #de77ae;">NAMESPACE</span> file (which you should never edit by hand)</li>
</ul>
<p>In this particular case, {RPiR} is not available on CRAN, so we’ve had to note its location in the</p>
<p>As well as recording dependencies, the <span style="color: #de77ae;">DESCRIPTION</span> file contains various metadata such as the package <code>Title</code>, <code>Authors@R</code>, and <code>Description.</code> Fill those in now.</p>
<p>Whenever you make a change to your package, you should try to get into the habit of changing the version number. This is important because it allows you to keep track of which version of the code is being used for a particular analysis. The format is usually <strong>major.minor.patch</strong>, more info <a href="https://semver.org">here</a>.</p>
<p>After making edits to the <span style="color: #de77ae;">DESCRIPTION</span> file, change the <span style="color: #de77ae;">Version</span> number to <code>0.1.0</code>.</p>
Then run <code>devtools::install()</code> to permanently install these changes as part of your package. 
<script type="application/shiny-prerendered" data-context="server-start">
library(learnr)

knitr::opts_chunk$set(error = TRUE)
options(knitr.kable.NA = '')

set.seed(123)
</script>
 <!--html_preserve-->
<script type="application/shiny-prerendered" data-context="dependencies">
{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["bootstrap"]},{"type":"character","attributes":{},"value":["3.3.5"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/bootstrap"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["viewport"]}},"value":[{"type":"character","attributes":{},"value":["width=device-width, initial-scale=1"]}]},{"type":"character","attributes":{},"value":["js/bootstrap.min.js","shim/html5shiv.min.js","shim/respond.min.js"]},{"type":"character","attributes":{},"value":["css/bootstrap.min.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["jquery"]},{"type":"character","attributes":{},"value":["1.11.3"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/jquery"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["jquery.min.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["navigation"]},{"type":"character","attributes":{},"value":["1.1"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/navigation-1.1"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["tabsets.js"]},{"type":"NULL"},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name","version","src","meta","script","stylesheet","head","attachment","package","all_files","pkgVersion"]},"class":{"type":"character","attributes":{},"value":["html_dependency"]}},"value":[{"type":"character","attributes":{},"value":["highlightjs"]},{"type":"character","attributes":{},"value":["9.12.0"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["file"]}},"value":[{"type":"character","attributes":{},"value":["rmd/h/highlightjs"]}]},{"type":"NULL"},{"type":"character","attributes":{},"value":["highlight.js"]},{"type":"character","attributes":{},"value":["default.css"]},{"type":"NULL"},{"type":"NULL"},{"type":"character","attributes":{},"value":["rmarkdown"]},{"type":"logical","attributes":{},"value":[true]},{"type":"character","attributes":{},"value":["2.6"]}]}]}
</script>
<!--/html_preserve-->
<!--html_preserve-->
<script type="application/shiny-prerendered" data-context="execution_dependencies">
{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["packages","version"]},"class":{"type":"character","attributes":{},"value":["data.frame"]},"row.names":{"type":"integer","attributes":{},"value":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]}},"value":[{"type":"character","attributes":{},"value":["backports","base","checkmate","codetools","compiler","curl","datasets","digest","ellipsis","evaluate","fastmap","gradethis","graphics","grDevices","highr","htmltools","htmlwidgets","httpuv","jsonlite","knitr","later","learnr","lifecycle","magrittr","markdown","MASS","methods","mime","promises","R6","Rcpp","rlang","rmarkdown","rprojroot","shiny","stats","stringi","stringr","tools","utils","withr","xfun","xtable","yaml"]},{"type":"character","attributes":{},"value":["1.2.1","4.0.3","2.0.0","0.2-16","4.0.3","4.3","4.0.3","0.6.27","0.3.1","0.14","1.1.0","0.2.0.9001","4.0.3","4.0.3","0.8","0.5.1.9000","1.5.3","1.5.5","1.7.2","1.30","1.1.0.1","0.10.1.9007","0.2.0","2.0.1","1.1","7.3-53","4.0.3","0.9","1.1.1","2.5.0","1.0.6","0.4.10","2.6","2.0.2","1.5.0","4.0.3","1.5.3","1.4.0","4.0.3","4.0.3","2.4.0","0.20","1.8-4","2.2.1"]}]}]}
</script>
<!--/html_preserve-->
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("section-TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
